(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.d({},{L:()=>h});var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tarea=e,this.id=(new Date).getTime(),this.completado=!1,this.creado=new Date}var r,n,o;return r=t,o=[{key:"fromJson",value:function(e){var r=e.id,n=e.tarea,o=e.completado,a=e.creado,i=new t(n);return i.id=r,i.completado=o,i.creado=a,i}}],(n=[{key:"imprimirClase",value:function(){console.log("".concat(this.tarea," - ").concat(this.id))}}])&&e(r.prototype,n),o&&e(r,o),t}();function n(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return c=t.done,t},e:function(t){l=!0,i=t},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw i}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cargarLocalStorage()}var e,o,i;return e=t,(o=[{key:"nuevoTodo",value:function(t){this.todos.push(t),this.guardarLocalStorage()}},{key:"eliminarTodo",value:function(t){this.todos=this.todos.filter((function(e){return e.id!=t})),this.guardarLocalStorage()}},{key:"marcarCompletado",value:function(t){var e,r=n(this.todos);try{for(r.s();!(e=r.n()).done;){var o=e.value;if(o.id==t){o.completado=!o.completado,this.guardarLocalStorage();break}}}catch(t){r.e(t)}finally{r.f()}}},{key:"borrarCompletados",value:function(){this.todos=this.todos.filter((function(t){return!t.completado})),this.guardarLocalStorage()}},{key:"guardarLocalStorage",value:function(){localStorage.setItem("todo",JSON.stringify(this.todos))}},{key:"cargarLocalStorage",value:function(){this.todos=localStorage.getItem("todo")?JSON.parse(localStorage.getItem("todo")):[],this.todos=this.todos.map((function(t){return r.fromJson(t)}))}}])&&a(e.prototype,o),i&&a(e,i),t}();function c(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var u=document.querySelector(".todo-list"),s=document.querySelector(".new-todo"),d=document.querySelector(".clear-completed"),f=document.querySelector(".filters"),m=document.querySelectorAll(".filtro"),v=function(t){var e='<li class=" '.concat(t.completado?"completed":"",' " data-id=" ').concat(t.id,' ">\n    <div class="view">\n        <input class="toggle" type="checkbox"  ').concat(t.completado?"checked":"","  >\n        <label>").concat(t.tarea,'</label>\n        <button class="destroy"></button>\n    </div>\n    <input class="edit" value="Create a TodoMVC template">\n    </li> '),r=document.createElement("div");return r.innerHTML=e,u.append(r.firstElementChild),r.firstElementChild};s.addEventListener("keyup",(function(t){if(13===t.keyCode&&s.value.length>0){var e=new r(s.value);h.nuevoTodo(e),v(e),s.value=""}})),u.addEventListener("click",(function(t){var e=t.target.localName,r=t.target.parentElement.parentElement,n=r.getAttribute("data-id");e.includes("input")?(h.marcarCompletado(n),r.classList.toggle("completed")):e.includes("button")&&(h.eliminarTodo(n),u.removeChild(r))})),d.addEventListener("click",(function(t){h.borrarCompletados();for(var e=u.children.length-1;e>=0;e--){var r=u.children[e];"completed"==r.className&&u.removeChild(r)}})),f.addEventListener("click",(function(t){var e=t.target.text;if(e){m.forEach((function(t){return t.classList.remove("selected")})),t.target.classList.add("selected");var r,n=c(u.children);try{for(n.s();!(r=n.n()).done;){var o=r.value;o.classList.remove("hidden");var a=o.classList.contains("completed");switch(e){case"Pendientes":a&&o.classList.add("hidden");break;case"Completados":a||o.classList.add("hidden")}}}catch(t){n.e(t)}finally{n.f()}}}));var h=new i;h.todos.forEach((function(t){return v(t)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJwYWNrLWluaWNpYWwvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vd2VicGFjay1pbmljaWFsL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly93ZWJwYWNrLWluaWNpYWwvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly93ZWJwYWNrLWluaWNpYWwvLi9zcmMvY2xhc3Nlcy90b2RvLmNsYXNzLmpzIiwid2VicGFjazovL3dlYnBhY2staW5pY2lhbC8uL3NyYy9jbGFzc2VzL3RvZG8tbGlzdC5jbGFzcy5qcyIsIndlYnBhY2s6Ly93ZWJwYWNrLWluaWNpYWwvLi9zcmMvanMvY29tcG9uZW50ZXMuanMiLCJ3ZWJwYWNrOi8vd2VicGFjay1pbmljaWFsLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiVG9kbyIsInRhcmVhIiwidGhpcyIsImlkIiwiRGF0ZSIsImdldFRpbWUiLCJjb21wbGV0YWRvIiwiY3JlYWRvIiwidGVtcFRvZG8iLCJjb25zb2xlIiwibG9nIiwiVG9kb0xpc3QiLCJjYXJnYXJMb2NhbFN0b3JhZ2UiLCJ0b2RvIiwidG9kb3MiLCJwdXNoIiwiZ3VhcmRhckxvY2FsU3RvcmFnZSIsImZpbHRlciIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0SXRlbSIsInBhcnNlIiwibWFwIiwiZnJvbUpzb24iLCJkaXZUb2RvTGlzdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInR4dElucHV0IiwiYm90b25FbGltaW5hclRvZG9zIiwidWxGaWx0cm9zIiwiYW5jaG9yRmlsdHJvcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjcmVhclRvZG9IdG1sIiwiaHRtbFRvZG8iLCJkaXYiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYXBwZW5kIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXlDb2RlIiwidmFsdWUiLCJsZW5ndGgiLCJudWV2b1RvZG8iLCJ0b2RvTGlzdCIsIm5vbWJyZUVsZW1lbnRvIiwidGFyZ2V0IiwibG9jYWxOYW1lIiwidG9kb0VsZW1lbnRvIiwicGFyZW50RWxlbWVudCIsInRvZG9JZCIsImdldEF0dHJpYnV0ZSIsImluY2x1ZGVzIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicmVtb3ZlQ2hpbGQiLCJpIiwiY2hpbGRyZW4iLCJlbGVtZW50byIsImNsYXNzTmFtZSIsImZpbHRybyIsInRleHQiLCJmb3JFYWNoIiwiZWxlbWVudCIsInJlbW92ZSIsImFkZCIsImNvbnRhaW5zIl0sIm1hcHBpbmdzIjoibUJBQ0EsSUFBSUEsRUFBc0IsQ0NBMUIsRUFBd0IsQ0FBQ0MsRUFBU0MsS0FDakMsSUFBSSxJQUFJQyxLQUFPRCxFQUNYRixFQUFvQkksRUFBRUYsRUFBWUMsS0FBU0gsRUFBb0JJLEVBQUVILEVBQVNFLElBQzVFRSxPQUFPQyxlQUFlTCxFQUFTRSxFQUFLLENBQUVJLFlBQVksRUFBTUMsSUFBS04sRUFBV0MsTUNKM0UsRUFBd0IsQ0FBQ00sRUFBS0MsSUFBVUwsT0FBT00sVUFBVUMsZUFBZUMsS0FBS0osRUFBS0MsSSx3TENDM0UsSUFBTUksRUFBYixXQVlJLFdBQVlDLEksNEZBQU8sU0FFZkMsS0FBS0QsTUFBUUEsRUFDYkMsS0FBS0MsSUFBSyxJQUFJQyxNQUFPQyxVQUNyQkgsS0FBS0ksWUFBYSxFQUNsQkosS0FBS0ssT0FBUyxJQUFJSCxLLFVBakIxQixPLEVBQUEsRSxFQUFBLHVCQUVJLFlBQXFELElBQWxDRCxFQUFrQyxFQUFsQ0EsR0FBSUYsRUFBOEIsRUFBOUJBLE1BQU9LLEVBQXVCLEVBQXZCQSxXQUFZQyxFQUFXLEVBQVhBLE9BQ2hDQyxFQUFXLElBQUlSLEVBQU1DLEdBSzNCLE9BSkFPLEVBQVNMLEdBQUtBLEVBQ2RLLEVBQVNGLFdBQWFBLEVBQ3RCRSxFQUFTRCxPQUFTQSxFQUVYQyxNLEVBUmYsNEJBcUJJLFdBQ0lDLFFBQVFDLElBQVIsVUFBZ0JSLEtBQUtELE1BQXJCLGNBQWtDQyxLQUFLQyxVLDJCQXRCL0MsSywwckNDQ08sSUFBTVEsRUFBYixXQUVJLGMsNEZBQWMsU0FFVlQsS0FBS1UscUIsVUFKYixPLEVBQUEsRyxFQUFBLHdCQVFJLFNBQVdDLEdBQ1BYLEtBQUtZLE1BQU1DLEtBQU1GLEdBQ2pCWCxLQUFLYyx3QkFWYiwwQkFjSSxTQUFjYixHQUNWRCxLQUFLWSxNQUFRWixLQUFLWSxNQUFNRyxRQUFRLFNBQUFKLEdBQUksT0FBSUEsRUFBS1YsSUFBTUEsS0FDbkRELEtBQUtjLHdCQWhCYiw4QkFvQkksU0FBa0JiLEdBQUssVUFDQ0QsS0FBS1ksT0FETixJQUNuQiwyQkFBaUMsS0FBckJELEVBQXFCLFFBQzdCLEdBQUtBLEVBQUtWLElBQU1BLEVBQUssQ0FDakJVLEVBQUtQLFlBQWNPLEVBQUtQLFdBQ3hCSixLQUFLYyxzQkFDTCxRQUxXLGlDQXBCM0IsK0JBZ0NJLFdBRUlkLEtBQUtZLE1BQVFaLEtBQUtZLE1BQU1HLFFBQVEsU0FBQUosR0FBSSxPQUFLQSxFQUFLUCxjQUM5Q0osS0FBS2Msd0JBbkNiLGlDQXNDSSxXQUNJRSxhQUFhQyxRQUFTLE9BQVFDLEtBQUtDLFVBQVVuQixLQUFLWSxVQXZDMUQsZ0NBMkNJLFdBRUlaLEtBQUtZLE1BQVVJLGFBQWFJLFFBQVEsUUFBYUYsS0FBS0csTUFBTUwsYUFBYUksUUFBUSxTQUFXLEdBRTVGcEIsS0FBS1ksTUFBUVosS0FBS1ksTUFBTVUsS0FBSyxTQUFBN0IsR0FBRyxPQUFJSyxFQUFLeUIsU0FBVTlCLFcsMkJBL0MzRCxLLG9oQ0NFQSxJQUFNK0IsRUFBY0MsU0FBU0MsY0FBYyxjQUNyQ0MsRUFBV0YsU0FBU0MsY0FBYyxhQUNsQ0UsRUFBcUJILFNBQVNDLGNBQWMsb0JBQzVDRyxFQUFZSixTQUFTQyxjQUFjLFlBQ25DSSxFQUFnQkwsU0FBU00saUJBQWlCLFdBR25DQyxFQUFnQixTQUFFckIsR0FHM0IsSUFBTXNCLEVBQVcsZUFBSCxPQUNHdEIsRUFBS1AsV0FBYyxZQUFjLEdBRHBDLHdCQUN1RE8sRUFBS1YsR0FENUQsdUZBR2lDVSxFQUFLUCxXQUFjLFVBQVksR0FIaEUsK0JBSUFPLEVBQUtaLE1BSkwsMklBVVJtQyxFQUFNVCxTQUFTVSxjQUFjLE9BS25DLE9BSkFELEVBQUlFLFVBQVlILEVBRWhCVCxFQUFZYSxPQUFRSCxFQUFJSSxtQkFFakJKLEVBQUlJLG1CQU9mWCxFQUFTWSxpQkFBaUIsU0FBUyxTQUFFQyxHQUVqQyxHQUF1QixLQUFsQkEsRUFBTUMsU0FBa0JkLEVBQVNlLE1BQU1DLE9BQVMsRUFBSSxDQUdyRCxJQUFNQyxFQUFZLElBQUk5QyxFQUFNNkIsRUFBU2UsT0FDckNHLFlBQW9CRCxHQUVwQlosRUFBZVksR0FDZmpCLEVBQVNlLE1BQVEsT0FNekJsQixFQUFZZSxpQkFBaUIsU0FBUyxTQUFDQyxHQUVuQyxJQUFNTSxFQUFpQk4sRUFBTU8sT0FBT0MsVUFFOUJDLEVBQWVULEVBQU1PLE9BQU9HLGNBQWNBLGNBRTFDQyxFQUFTRixFQUFhRyxhQUFjLFdBR3JDTixFQUFlTyxTQUFTLFVBQ3pCUixtQkFBMkJNLEdBQzNCRixFQUFhSyxVQUFVQyxPQUFPLGNBRXRCVCxFQUFlTyxTQUFTLFlBQ2hDUixlQUFzQk0sR0FDdEIzQixFQUFZZ0MsWUFBYVAsT0FNakNyQixFQUFtQlcsaUJBQWlCLFNBQVMsU0FBRUMsR0FFM0NLLHNCQUdBLElBQU0sSUFBSVksRUFBSWpDLEVBQVlrQyxTQUFTZixPQUFTLEVBQUdjLEdBQUksRUFBSUEsSUFBTSxDQUV6RCxJQUFNRSxFQUFXbkMsRUFBWWtDLFNBQVNELEdBQ1gsYUFBdEJFLEVBQVNDLFdBRVZwQyxFQUFZZ0MsWUFBYUcsT0FLckM5QixFQUFVVSxpQkFBaUIsU0FBUyxTQUFFQyxHQUNsQyxJQUFNcUIsRUFBU3JCLEVBQU1PLE9BQU9lLEtBRzVCLEdBQUtELEVBQUwsQ0FFQS9CLEVBQWNpQyxTQUFRLFNBQUFDLEdBQU8sT0FBSUEsRUFBUVYsVUFBVVcsT0FBTyxlQUMxRHpCLEVBQU1PLE9BQU9PLFVBQVVZLElBQUksWUFQa0IsVUFTckIxQyxFQUFZa0MsVUFUUyxJQVM3QywyQkFBK0MsS0FBbkNDLEVBQW1DLFFBRTNDQSxFQUFTTCxVQUFVVyxPQUFPLFVBRzFCLElBQU03RCxFQUFhdUQsRUFBU0wsVUFBVWEsU0FBUyxhQUkvQyxPQUFTTixHQUNMLElBQUssYUFDR3pELEdBQ0F1RCxFQUFTTCxVQUFVWSxJQUFLLFVBRTVCLE1BQ0osSUFBSyxjQUNJOUQsR0FDRHVELEVBQVNMLFVBQVVZLElBQUssWUExQkssbUNDOUUxQyxJQUFNckIsRUFBVyxJQUFJcEMsRUFFNUJvQyxFQUFTakMsTUFBTW1ELFNBQVMsU0FBQXBELEdBQUksT0FBSXFCLEVBQWNyQixPIiwiZmlsZSI6Im1haW4uYmM0MWQ5YzhkODk4Y2ZlZTRhM2IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIlxyXG5leHBvcnQgY2xhc3MgVG9kbyB7XHJcblxyXG4gICAgc3RhdGljIGZyb21Kc29uKCB7IGlkLCB0YXJlYSwgY29tcGxldGFkbywgY3JlYWRvIH0gKSB7XHJcbiAgICAgICAgY29uc3QgdGVtcFRvZG8gPSBuZXcgVG9kbyggdGFyZWEgKTsgXHJcbiAgICAgICAgdGVtcFRvZG8uaWQgPSBpZDtcclxuICAgICAgICB0ZW1wVG9kby5jb21wbGV0YWRvID0gY29tcGxldGFkbztcclxuICAgICAgICB0ZW1wVG9kby5jcmVhZG8gPSBjcmVhZG87IFxyXG5cclxuICAgICAgICByZXR1cm4gdGVtcFRvZG87IFxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih0YXJlYSkge1xyXG5cclxuICAgICAgICB0aGlzLnRhcmVhID0gdGFyZWE7IFxyXG4gICAgICAgIHRoaXMuaWQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgLy8gTsO6bWVybyBxdWUgcmVwcmVzZW50YSAgRmVjaGEvSEgvTU0vU1MvTU0gKE7Dum1lcm8gw7puaWNvKVxyXG4gICAgICAgIHRoaXMuY29tcGxldGFkbyA9IGZhbHNlOyBcclxuICAgICAgICB0aGlzLmNyZWFkbyA9IG5ldyBEYXRlKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGltcHJpbWlyQ2xhc2UoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYCR7IHRoaXMudGFyZWEgfSAtICR7IHRoaXMuaWQgfWApO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IFRvZG8gfSBmcm9tIFwiLi90b2RvLmNsYXNzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgVG9kb0xpc3Qge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIC8vIHRoaXMudG9kb3MgPSBbXTsgXHJcbiAgICAgICAgdGhpcy5jYXJnYXJMb2NhbFN0b3JhZ2UoKTsgXHJcblxyXG4gICAgfVxyXG5cclxuICAgIG51ZXZvVG9kbyggdG9kbyApIHtcclxuICAgICAgICB0aGlzLnRvZG9zLnB1c2goIHRvZG8gKTsgXHJcbiAgICAgICAgdGhpcy5ndWFyZGFyTG9jYWxTdG9yYWdlKCk7IFxyXG5cclxuICAgIH1cclxuXHJcbiAgICBlbGltaW5hclRvZG8oIGlkICkge1xyXG4gICAgICAgIHRoaXMudG9kb3MgPSB0aGlzLnRvZG9zLmZpbHRlciggdG9kbyA9PiB0b2RvLmlkICE9IGlkICkgO1xyXG4gICAgICAgIHRoaXMuZ3VhcmRhckxvY2FsU3RvcmFnZSgpOyBcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbWFyY2FyQ29tcGxldGFkbyggaWQgKSB7IFxyXG4gICAgICAgIGZvciAoIGNvbnN0IHRvZG8gb2YgdGhpcy50b2RvcyApIHtcclxuICAgICAgICAgICAgaWYgKCB0b2RvLmlkID09IGlkICkge1xyXG4gICAgICAgICAgICAgICAgdG9kby5jb21wbGV0YWRvID0gIXRvZG8uY29tcGxldGFkbzsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLmd1YXJkYXJMb2NhbFN0b3JhZ2UoKTsgXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGJvcnJhckNvbXBsZXRhZG9zKCApIHtcclxuXHJcbiAgICAgICAgdGhpcy50b2RvcyA9IHRoaXMudG9kb3MuZmlsdGVyKCB0b2RvID0+ICF0b2RvLmNvbXBsZXRhZG8gKSA7XHJcbiAgICAgICAgdGhpcy5ndWFyZGFyTG9jYWxTdG9yYWdlKCk7IFxyXG4gICAgfVxyXG5cclxuICAgIGd1YXJkYXJMb2NhbFN0b3JhZ2UoKSB7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oICd0b2RvJywgSlNPTi5zdHJpbmdpZnkodGhpcy50b2RvcykgKTsgXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNhcmdhckxvY2FsU3RvcmFnZSgpIHsgXHJcblxyXG4gICAgICAgIHRoaXMudG9kb3MgPSAoIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2RvJykgKSA/ICBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2RvJykpIDogW10gOyBcclxuXHJcbiAgICAgICAgdGhpcy50b2RvcyA9IHRoaXMudG9kb3MubWFwKCBvYmogPT4gVG9kby5mcm9tSnNvbiggb2JqICkgKSA7IFxyXG5cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbiIsImltcG9ydCB7IHRvZG9MaXN0IH0gZnJvbSBcIi4uL2luZGV4XCI7XG5pbXBvcnQgeyBUb2RvIH0gZnJvbSBcIi4uL2NsYXNzZXNcIjtcblxuLy8gUmVmZXJlbmNpYXMgZW4gZWwgSFRNTCBcbmNvbnN0IGRpdlRvZG9MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZG8tbGlzdCcpOyBcbmNvbnN0IHR4dElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy10b2RvJyk7IFxuY29uc3QgYm90b25FbGltaW5hclRvZG9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsZWFyLWNvbXBsZXRlZCcpOyBcbmNvbnN0IHVsRmlsdHJvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5maWx0ZXJzJyk7XG5jb25zdCBhbmNob3JGaWx0cm9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZpbHRybycpOyBcblxuXG5leHBvcnQgY29uc3QgY3JlYXJUb2RvSHRtbCA9ICggdG9kbyApID0+IHtcblxuXG4gICAgY29uc3QgaHRtbFRvZG8gPSBcbiAgICBgPGxpIGNsYXNzPVwiICR7ICh0b2RvLmNvbXBsZXRhZG8pID8gJ2NvbXBsZXRlZCcgOiAnJyB9IFwiIGRhdGEtaWQ9XCIgJHt0b2RvLmlkfSBcIj5cbiAgICA8ZGl2IGNsYXNzPVwidmlld1wiPlxuICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0b2dnbGVcIiB0eXBlPVwiY2hlY2tib3hcIiAgJHsgKHRvZG8uY29tcGxldGFkbykgPyAnY2hlY2tlZCcgOiAnJyB9ICA+XG4gICAgICAgIDxsYWJlbD4keyB0b2RvLnRhcmVhIH08L2xhYmVsPlxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwiZGVzdHJveVwiPjwvYnV0dG9uPlxuICAgIDwvZGl2PlxuICAgIDxpbnB1dCBjbGFzcz1cImVkaXRcIiB2YWx1ZT1cIkNyZWF0ZSBhIFRvZG9NVkMgdGVtcGxhdGVcIj5cbiAgICA8L2xpPiBgXG5cbiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkaXYuaW5uZXJIVE1MID0gaHRtbFRvZG87XG5cbiAgICBkaXZUb2RvTGlzdC5hcHBlbmQoIGRpdi5maXJzdEVsZW1lbnRDaGlsZCApO1xuXG4gICAgcmV0dXJuIGRpdi5maXJzdEVsZW1lbnRDaGlsZDtcblxuXG59XG5cbi8vIEV2ZW50b3MgXG5cbnR4dElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKCBldmVudCApID0+IHtcblxuICAgIGlmICggZXZlbnQua2V5Q29kZSA9PT0gMTMgJiYgdHh0SW5wdXQudmFsdWUubGVuZ3RoID4gMCApIHtcblxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0eHRJbnB1dC52YWx1ZSk7XG4gICAgICAgIGNvbnN0IG51ZXZvVG9kbyA9IG5ldyBUb2RvKCB0eHRJbnB1dC52YWx1ZSApOyBcbiAgICAgICAgdG9kb0xpc3QubnVldm9Ub2RvKCBudWV2b1RvZG8gKTtcblxuICAgICAgICBjcmVhclRvZG9IdG1sKCBudWV2b1RvZG8gKTsgXG4gICAgICAgIHR4dElucHV0LnZhbHVlID0gJyc7IFxuXG4gICAgfVxuXG59KTsgXG5cbmRpdlRvZG9MaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG5cbiAgICBjb25zdCBub21icmVFbGVtZW50byA9IGV2ZW50LnRhcmdldC5sb2NhbE5hbWU7ICAvLyBpbnB1dCwgbGFiZWwsIGJ1dHRvbiBcbiAgICAvLyBjb25zb2xlLmxvZyhub21icmVFbGVtZW50byk7XG4gICAgY29uc3QgdG9kb0VsZW1lbnRvID0gZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDsgXG4gICAgLy8gY29uc29sZS5sb2codG9kb0VsZW1lbnRvKTtcbiAgICBjb25zdCB0b2RvSWQgPSB0b2RvRWxlbWVudG8uZ2V0QXR0cmlidXRlKCAnZGF0YS1pZCcpOyBcbiAgICAvLyBjb25zb2xlLmxvZyh0b2RvSWQpO1xuXG4gICAgaWYgKCBub21icmVFbGVtZW50by5pbmNsdWRlcygnaW5wdXQnKSkgeyAgLy8gY2xpY2sgZW4gZWwgQ2hlY2sgXG4gICAgICAgIHRvZG9MaXN0Lm1hcmNhckNvbXBsZXRhZG8oIHRvZG9JZCApOyBcbiAgICAgICAgdG9kb0VsZW1lbnRvLmNsYXNzTGlzdC50b2dnbGUoJ2NvbXBsZXRlZCcpOyBcblxuICAgIH0gZWxzZSBpZiAoIG5vbWJyZUVsZW1lbnRvLmluY2x1ZGVzKCdidXR0b24nKSkgeyAgLy8gY2xpY2sgZW4gZWxpbWluYXIgKHgpIFxuICAgICAgICB0b2RvTGlzdC5lbGltaW5hclRvZG8odG9kb0lkKTsgXG4gICAgICAgIGRpdlRvZG9MaXN0LnJlbW92ZUNoaWxkKCB0b2RvRWxlbWVudG8gKTsgXG4gICAgfVxuICAgIC8vIGNvbnNvbGUubG9nKHRvZG9MaXN0KTtcblxufSk7XG5cbmJvdG9uRWxpbWluYXJUb2Rvcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICggZXZlbnQgKSA9PiB7XG5cbiAgICB0b2RvTGlzdC5ib3JyYXJDb21wbGV0YWRvcygpOyBcbiAgICAvLyBjb25zb2xlLmxvZyh0b2RvTGlzdCk7XG5cbiAgICBmb3IgKCBsZXQgaSA9IGRpdlRvZG9MaXN0LmNoaWxkcmVuLmxlbmd0aCAtIDE7IGk+PSAwOyAgaS0tICkge1xuXG4gICAgICAgIGNvbnN0IGVsZW1lbnRvID0gZGl2VG9kb0xpc3QuY2hpbGRyZW5baV07XG4gICAgICAgIGlmICggZWxlbWVudG8uY2xhc3NOYW1lID09ICdjb21wbGV0ZWQnICl7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlbGVtZW50byk7XG4gICAgICAgICAgICBkaXZUb2RvTGlzdC5yZW1vdmVDaGlsZCggZWxlbWVudG8gKTsgXG4gICAgICAgIH1cbiAgICB9XG59KTsgXG5cbnVsRmlsdHJvcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICggZXZlbnQgKSA9PiB7XG4gICAgY29uc3QgZmlsdHJvID0gZXZlbnQudGFyZ2V0LnRleHQ7IFxuICAgIC8vIGNvbnNvbGUubG9nKGZpbHRybyk7XG5cbiAgICBpZiggIWZpbHRybykgeyByZXR1cm47IH0gIFxuXG4gICAgYW5jaG9yRmlsdHJvcy5mb3JFYWNoKGVsZW1lbnQgPT4gZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpKTsgXG4gICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcblxuICAgIGZvciAoIGNvbnN0IGVsZW1lbnRvIG9mIGRpdlRvZG9MaXN0LmNoaWxkcmVuICkge1xuXG4gICAgICAgIGVsZW1lbnRvLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXG5cbiAgICAgICAgY29uc3QgY29tcGxldGFkbyA9IGVsZW1lbnRvLmNsYXNzTGlzdC5jb250YWlucygnY29tcGxldGVkJyk7IFxuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGNvbXBsZXRhZG8pO1xuXG4gICAgICAgIHN3aXRjaCAoIGZpbHRybyApIHsgXG4gICAgICAgICAgICBjYXNlICdQZW5kaWVudGVzJzogXG4gICAgICAgICAgICAgICAgaWYgKGNvbXBsZXRhZG8pIHsgXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRvLmNsYXNzTGlzdC5hZGQoICdoaWRkZW4nKTsgXG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICBicmVhazsgXG4gICAgICAgICAgICBjYXNlICdDb21wbGV0YWRvcyc6XG4gICAgICAgICAgICAgICAgaWYgKCFjb21wbGV0YWRvKSB7IFxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50by5jbGFzc0xpc3QuYWRkKCAnaGlkZGVuJyk7IFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhazsgXG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG59KVxuXG5cblxuXG4iLCJcbmltcG9ydCAnLi9zdHlsZXMuY3NzJzsgXG4vLyBpbXBvcnQgeyBzYWx1ZGFyIH0gZnJvbSAnLi9qcy9jb21wb25lbnRlcyc7IFxuLy8gaW1wb3J0IHsgVG9kbyB9IGZyb20gJy4vY2xhc3Nlcy90b2RvLmNsYXNzJzsgXG4vLyBpbXBvcnQgeyBUb2RvTGlzdCB9IGZyb20gJy4vY2xhc3Nlcy90b2RvLWxpc3QuY2xhc3MnOyBcbmltcG9ydCB7IFRvZG8sIFRvZG9MaXN0IH0gZnJvbSAnLi9jbGFzc2VzJzsgXG5pbXBvcnQgeyBjcmVhclRvZG9IdG1sIH0gZnJvbSAnLi9qcy9jb21wb25lbnRlcyc7XG5cblxuZXhwb3J0IGNvbnN0IHRvZG9MaXN0ID0gbmV3IFRvZG9MaXN0KCk7IFxuXG50b2RvTGlzdC50b2Rvcy5mb3JFYWNoKCB0b2RvID0+IGNyZWFyVG9kb0h0bWwodG9kbykpOyBcblxuXG4vLyB0b2RvTGlzdC50b2Rvc1swXS5pbXByaW1pckNsYXNlKCk7IFxuXG4vLyBjb25zb2xlLmxvZyh0eXBlb2YgdG9kb0xpc3QudG9kb3NbMV0gKTtcblxuLy8gY29uc3QgdGFyZWEgPSBuZXcgVG9kbyAoJ0FwcmVuZGVyIEphdmFzY3JpcHQgISEnKTsgXG5cbi8vICB0YXJlYS5jb21wbGV0YWRvID0gdHJ1ZTsgXG5cbi8vIHRvZG9MaXN0Lm51ZXZvVG9kbyh0YXJlYSk7IFxuXG5cbi8vIGNvbnNvbGUubG9nKCB0b2RvTGlzdCApO1xuXG4vLyBjcmVhclRvZG9IdG1sKCB0YXJlYSApOyBcblxuXG5cbiJdLCJzb3VyY2VSb290IjoiIn0=